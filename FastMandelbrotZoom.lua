-- title: Fast Mandelbrot Zoom
-- author: Movie Vertigo
-- desc: A 60fps Mandelbrot explorer
-- script: lua
-- input: mouse
-- saveid: FastMandelbrotZoom

local SCREENWIDTH = 240
local SCREENHEIGHT = 136
local INITIALITERATIONS = 256
local INITIALTARGETX = -0.5
local INITIALTARGETY = 0.0
local INITIALSIZE = 3.1
local INITIALSPEED = 1.01
local TIMEPERFRAME = 12

local SCREENRATIO = SCREENWIDTH / SCREENHEIGHT

local targetX = INITIALTARGETX
local targetY = INITIALTARGETY
local size = INITIALSIZE
local iterations = INITIALITERATIONS
local speed = INITIALSPEED

local drawfull = true
local fixRowNext = true

local colXValues = {}
local rowYValues = {}
local oldColXValues = {}
local oldRowYValues = {}
local colErrors = {}
local rowErrors = {}

local previousFrameTime = time()

function mandelbrotpixel(pX, pY)
    local x = pX
    local y = pY
    local x2 = x*x
    local y2 = y*y
    local q = (x-0.25)*(x-0.25)+y2
    if q*(q+x-0.25) <= 0.25*y2 or (x+1.0)*(x+1.0)+y2 <= 0.0625 then return iterations end

    local i = 0
    while x2 + y2 < 4 and i < iterations  do
        y = pY + (x+x) * y
        x = pX + x2 - y2
        x2 = x*x
        y2 = y*y
        i = i + 1
    end
    return i
end

function mandelbrotcol(addr, pX)
    for row = 0, SCREENHEIGHT-1 do
        local i = mandelbrotpixel(pX, rowYValues[row])
        poke4(addr, i == iterations and i or (i % 15)+1)
        addr = addr + SCREENWIDTH
    end
end

function mandelbrotrow(addr, pY)
    for col = 0, SCREENWIDTH-1 do
        local i = mandelbrotpixel(colXValues[col], pY)
        poke4(addr, i == iterations and i or (i % 15)+1)
        addr = addr + 1
    end
end

function fixworstcol(buffer)
    local worstError = 0
    local worstCol = 0
    for col = 0, SCREENWIDTH-1 do
        if colErrors[col] > worstError then
            worstError = colErrors[col]
            worstCol = col
        end
    end

    local sizeX = size * SCREENRATIO
    local minX = targetX - sizeX/2
    local pX = minX + (worstCol * sizeX) / SCREENWIDTH
    mandelbrotcol(buffer+worstCol, pX)
    colXValues[worstCol] = pX
    colErrors[worstCol] = 0
end

function fixworstrow(buffer)
    local worstError = 0
    local worstRow = 0
    for row = 0, SCREENHEIGHT-1 do
        if rowErrors[row] > worstError then
            worstError = rowErrors[row]
            worstRow = row
        end
    end

    local minY = targetY - size/2
    local pY = minY + (worstRow * size) / SCREENHEIGHT
    mandelbrotrow(buffer+worstRow*SCREENWIDTH, pY)
    rowYValues[worstRow] = pY
    rowErrors[worstRow] = 0
end
    
function fullmandelbrot()
    local sizeX = size * SCREENRATIO
    local minX = targetX - sizeX/2
    local minY = targetY - size/2
    local addr = 0

    for col = 0, SCREENWIDTH-1 do
        colXValues[col] = minX + (col * sizeX) / SCREENWIDTH
        colErrors[col] = 0
    end

    for row = 0, SCREENHEIGHT-1 do
        local pY = minY + (row * size) / SCREENHEIGHT
        rowYValues[row] = pY
        rowErrors[row] = 0
        mandelbrotrow(addr, pY)
        addr = addr + SCREENWIDTH
    end
end

function scale(srcBuffer, dstBuffer)
    local sizeX = size * SCREENRATIO
    local minX = targetX - sizeX/2
    local minY = targetY - size/2

    for i = 0, SCREENWIDTH-1 do
        oldColXValues[i] = colXValues[i]
    end
    for i = 0, SCREENHEIGHT-1 do
        oldRowYValues[i] = rowYValues[i]
    end

    local srcCol = 0
    local srcCols = {}
    for dstCol = 0, SCREENWIDTH-1 do
        local pX = minX + (dstCol * sizeX) / SCREENWIDTH
        while oldColXValues[srcCol] < pX and srcCol < SCREENWIDTH - 1 do
            srcCol = srcCol + 1
        end
        if srcCol > 0 and math.abs(oldColXValues[srcCol-1]-pX) < math.abs(oldColXValues[srcCol]-pX) then
            srcCol = srcCol - 1
        end
        srcCols[dstCol] = srcCol
        colXValues[dstCol] = oldColXValues[srcCol]
        colErrors[dstCol] = math.abs(colXValues[dstCol]-pX)
    end

    local srcRow = 0
    local srcRows = {}
    for dstRow = 0, SCREENHEIGHT-1 do
        local pY = minY + (dstRow * size) / SCREENHEIGHT
        while oldRowYValues[srcRow] < pY and srcRow < SCREENHEIGHT - 1 do
            srcRow = srcRow + 1
        end
        if srcRow > 0 and math.abs(oldRowYValues[srcRow-1]-pY) < math.abs(oldRowYValues[srcRow]-pY) then
            srcRow = srcRow - 1
        end
        srcRows[dstRow] = srcRow
        rowYValues[dstRow] = oldRowYValues[srcRow]
        rowErrors[dstRow] = math.abs(rowYValues[dstRow]-pY)
    end

    for dstRow = 0, SCREENHEIGHT-1 do
        for dstCol = 0, SCREENWIDTH-1 do
            poke4(dstBuffer, peek4(srcBuffer + srcRows[dstRow] * SCREENWIDTH + srcCols[dstCol]))
            dstBuffer = dstBuffer + 1
        end
    end
end

function reset()
    targetX = INITIALTARGETX
    targetY = INITIALTARGETY
    size = INITIALSIZE
    iterations = INITIALITERATIONS
    speed = INITIALSPEED

    drawfull = true
    fixRowNext = true
end

function controls()
    local x,y,left,middle,right = mouse()
    if (left or right) and x >= 0 and y >= 0 and x < SCREENWIDTH and y < SCREENHEIGHT then
        local oldSize = size
        if left  then size = size / speed end
        if right then size = size * speed end
        targetX = targetX + (oldSize - size) * (1 * x / SCREENWIDTH - 0.5) * SCREENRATIO
        targetY = targetY + (oldSize - size) * (1 * y / SCREENHEIGHT - 0.5)
    end

    if btn(0) then targetY = targetY - size * (speed-1) end
    if btn(1) then targetY = targetY + size * (speed-1) end
    if btn(2) then targetX = targetX - size * (speed-1) end
    if btn(3) then targetX = targetX + size * (speed-1) end
    if btn(4) then size = size / speed end
    if btn(5) then size = size * speed end

    if middle or btn(6) then reset() end
end

function TIC()
    local startTime = time()

    if drawfull then
        fullmandelbrot()
        drawfull = false
    else
        scale(0, 0x8000)
        local strips = 0
        while time() - startTime < TIMEPERFRAME do
            if fixRowNext then
                fixworstrow(0x8000)
            else
                fixworstcol(0x8000)
            end
            fixRowNext = not fixRowNext
            strips = strips + 1
        end
        memcpy(0, 0x4000, SCREENWIDTH * SCREENHEIGHT / 2)
    end

    controls()
end

-- <SCREEN>
-- 000:111111111111111111111111111111111111111111111111111111111111111111111111111111111111111222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111111111111111111
-- 001:111111111111111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111111111111111
-- 002:111111111111111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111111111111111
-- 003:111111111111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111111111111111
-- 004:111111111111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111111111111
-- 005:111111111111111111111111111111111111111111111111111111111111111111111111111111111222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111111111111
-- 006:111111111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111111111
-- 007:111111111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111111111
-- 008:111111111111111111111111111111111111111111111111111111111111111111111111111111222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111111111
-- 009:111111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111111111
-- 010:111111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222222222222222222233333222222222222222222222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111111
-- 011:111111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222222222222222333333333333333333333333322222222222222222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111111
-- 012:111111111111111111111111111111111111111111111111111111111111111111111111111222222222222222222222222222233333333333333333333333333333333333222222222222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111111
-- 013:111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222333333333333333333333333333333333333333333322222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111
-- 014:111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222222333333333333333333333333333333333333333333333333322222222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111
-- 015:111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222333333333333333333333333333333333333333333333333333333322222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111
-- 016:111111111111111111111111111111111111111111111111111111111111111111111111222222222222222222233333333333333333333333333333333333333333333333333333333333222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111
-- 017:111111111111111111111111111111111111111111111111111111111111111111111112222222222222222223333333333333333333333333333333333333334444444444444433333333332222222222222222222222222222222222222222222222222222222222222211111111111111111111111111
-- 018:111111111111111111111111111111111111111111111111111111111111111111111122222222222222222333333333333333333333333333333333333344444444455555444444433333333322222222222222222222222222222222222222222222222222222222222221111111111111111111111111
-- 019:111111111111111111111111111111111111111111111111111111111111111111111122222222222222233333333333333333333333333333333333334444444445b97755554444444333333333222222222222222222222222222222222222222222222222222222222221111111111111111111111111
-- 020:11111111111111111111111111111111111111111111111111111111111111111111122222222222222333333333333333333333333333333333333444444444455579b965555444444443333333332222222222222222222222222222222222222222222222222222222222111111111111111111111111
-- 021:11111111111111111111111111111111111111111111111111111111111111111111222222222222233333333333333333333333333333333333334444444444555668b976665544444444433333333322222222222222222222222222222222222222222222222222222222211111111111111111111111
-- 022:11111111111111111111111111111111111111111111111111111111111111111111222222222222333333333333333333333333333333333333444444444445555667bd97666654444444443333333332222222222222222222222222222222222222222222222222222222211111111111111111111111
-- 023:1111111111111111111111111111111111111111111111111111111111111111111222222222222333333333333333333333333333333333334444444444444555566776c8777975444444444333333333222222222222222222222222222222222222222222222222222222221111111111111111111111
-- 024:111111111111111111111111111111111111111111111111111111111111111111122222222223333333333333333333333333333333333334444444444444555556679bba9a9ea6544444444433333333332222222222222222222222222222222222222222222222222222221111111111111111111111
-- 025:1111111111111111111111111111111111111111111111111111111111111111112222222222333333333333333333333333333333333334444444444444455555567789bec14176554444444444333333333222222222222222222222222222222222222222222222222222222111111111111111111111
-- 026:1111111111111111111111111111111111111111111111111111111111111111122222222223333333333333333333333333333333333344444444444444555555667889bf3c9876655444444444433333333322222222222222222222222222222222222222222222222222222111111111111111111111
-- 027:111111111111111111111111111111111111111111111111111111111111111112222222223333333333333333333333333333333333344444444444444555555567788ab3fb9876655544444444433333333332222222222222222222222222222222222222222222222222222211111111111111111111
-- 028:111111111111111111111111111111111111111111111111111111111111111122222222333333333333333333333333333333333334444444444444444555555677889eef1c9877655554444444443333333333322222222222222222222222222222222222222222222222222221111111111111111111
-- 029:11111111111111111111111111111111111111111111111111111111111111112222222333333333333333333333333333333333334444444444444444555555677a9ac3a067a887655555444444444333333333332222222222222222222222222222222222222222222222222221111111111111111111
-- 030:11111111111111111111111111111111111111111111111111111111111111122222223333333333333333333333333333333333344444444444444445555556689dfcdf00c1ca9d765555554444444433333333333222222222222222222222222222222222222222222222222222111111111111111111
-- 031:111111111111111111111111111111111111111111111111111111111111111222222333333333333333333333333333333333334444444444444445555556667e332f49c034fccd865555555444444443333333333322222222222222222222222222222222222222222222222222111111111111111111
-- 032:1111111111111111111111111111111111111111111111111111111111111122222223333333333333333333333333333333333444444444444444555556666789b11400000c62df876555555554444443333333333322222222222222222222222222222222222222222222222222111111111111111111
-- 033:1111111111111111111111111111111111111111111111111111111111111122222233333333333333333333333333333333344444444444444445555666667788aea0000000434b876655555555444444333333333332222222222222222222222222222222222222222222222222211111111111111111
-- 034:1111111111111111111111111111111111111111111111111111111111111122222333333333333333333333333333333333444444444444444555566666677788b3d000000009ea877666555555544444433333333333222222222222222222222222222222222222222222222222211111111111111111
-- 035:11111111111111111111111111111111111111111111111111111111111112222233333333333333333333333333333333344444444444444455566666667778892600000000047b887766665555555444433333333333322222222222222222222222222222222222222222222222221111111111111111
-- 036:111111111111111111111111111111111111111111111111111111111111122223333333333333333333333333333333334444444444444455566666677777889abe300000000dea988776666666655544443333333333332222222222222222222222222222222222222222222222221111111111111111
-- 037:111111111111111111111111111111111111111111111111111111111111222223333333333333333333333333333333344444444444445555677789887788999abea000000005db998877666666677554443333333333332222222222222222222222222222222222222222222222222111111111111111
-- 038:111111111111111111111111111111111111111111111111111111111111222233333333333333333333333333333334444444444444555556a8aab7a8889ccbabce28000000b1dcba9a9877777779c755444333333333333222222222222222222222222222222222222222222222222111111111111111
-- 039:1111111111111111111111111111111111111111111111111111111111112223333333333333333333333333333333444444444445555555678b9846ba9abdfee2144750000f642faecf968877778ae765444333333333333322222222222222222222222222222222222222222222222111111111111111
-- 040:1111111111111111111111111111111111111111111111111111111111122223333333333333333333333333333334444444444555555556678ae56131bbd705505000000000000f0c11ba9988999df875544433333333333322222222222222222222222222222222222222222222222211111111111111
-- 041:111111111111111111111111111111111111111111111111111111111112223333333333333333333333333333334444444445555555556667868346deed100c000000000000000000d0cebaaf1dbd2be6554433333333333332222222222222222222222222222222222222222222222211111111111111
-- 042:1111111111111111111111111111111111111111111111111111111111122333333333333333333333333333334444444455555555555666678ac1c00094000000000000000000000000e34cc183421d86554443333333333333222222222222222222222222222222222222222222222211111111111111
-- 043:11111111111111111111111111111111111111111111111111111111112223333333333333333333333333333444444555555555555566667789bcf000a0000000000000000000000000008f100005fa86554443333333333333222222222222222222222222222222222222222222222221111111111111
-- 044:11111111111111111111111111111111111111111111111111111111112233333333333333333333333333344444455555555555555666667889cb400000000000000000000000000000000f900004b976555443333333333333322222222222222222222222222222222222222222222221111111111111
-- 045:1111111111111111111111111111111111111111111111111111111111223333333333333333333333333344444555555555555555666667889abe5700000000000000000000000000000000e000041876555444333333333333322222222222222222222222222222222222222222222221111111111111
-- 046:11111111111111111111111111111111111111111111111111111111122333333333333333333333333344444555555555555555666666789ddbd72900000000000000000000000000000000000063a776555444333333333333332222222222222222222222222222222222222222222221111111111111
-- 047:111111111111111111111111111111111111111111111111111111111223333333333333333333333344444555555555555555566666677bc21e3000000000000000000000000000000000000036fb9776655444433333333333332222222222222222222222222222222222222222222222111111111111
-- 048:111111111111111111111111111111111111111111111111111111111223333333333333333333334444456666665555555556666667778b96379000000000000000000000000000000000000000cb9876655544433333333333332222222222222222222222222222222222222222222222111111111111
-- 049:111111111111111111111111111111111111111111111111111111111233333333333333333334444445588766666666666666666777789ac20000000000000000000000000000000000000000006eb887655544433333333333333222222222222222222222222222222222222222222222111111111111
-- 050:11111111111111111111111111111111111111111111111111111111123333333333333333444444455567bc87666666666777777777889ac700000000000000000000000000000000000000000002b999965544443333333333333222222222222222222222222222222222222222222222111111111111
-- 051:1111111111111111111111111111111111111111111111111111111122333333333333344444444455566793887777778b8777777778889be250000000000000000000000000000000000000000006d8bb675544443333333333333222222222222222222222222222222222222222222222211111111111
-- 052:11111111111111111111111111111111111111111111111111111111233333333333444444444455555667aea8877788b7988777778889df8800000000000000000000000000000000000000000000c012a75544443333333333333322222222222222222222222222222222222222222222211111111111
-- 053:11111111111111111111111111111111111111111111111111111111233333333344444444444555556668a9ba9aa99a5eb9998888889abd0d00000000000000000000000000000000000000000000000bc75544443333333333333322222222222222222222222222222222222222222222211111111111
-- 054:111111111111111111111111111111111111111111111111111111112333333344444444444455555566688d29fecaabd21cbcc99999aac2d0000000000000000000000000000000000000000000000041865544444333333333333322222222222222222222222222222222222222222222211111111111
-- 055:111111111111111111111111111111111111111111111111111111113333334444444444444555555566778abed211ccd2f4d7dba99aab2110000000000000000000000000000000000000000000000fb9765544444333333333333332222222222222222222222222222222222222222222211111111111
-- 056:1111111111111111111111111111111111111111111111111111111133333444444444444455555555667789ad1141fb2c09551d5baabc40000000000000000000000000000000000000000000000006a8765544444333333333333332222222222222222222222222222222222222222222211111111111
-- 057:1111111111111111111111111111111111111111111111111111111233334444444444444555555556677789aec00084f8000f04ddbbcd89000000000000000000000000000000000000000000000001bb765544444333333333333332222222222222222222222222222222222222222222211111111111
-- 058:1111111111111111111111111111111111111111111111111111111233344444444444445555555556777799be4000000000000002edde800000000000000000000000000000000000000000000000005e865544444433333333333332222222222222222222222222222222222222222222221111111111
-- 059:11111111111111111111111111111111111111111111111111111113334444444444444555555555677778abce4e00000000000000eee160000000000000000000000000000000000000000000000000d1765544444433333333333333222222222222222222222222222222222222222222221111111111
-- 060:1111111111111111111111111111111111111111111111111111111334444444444444555555555677888abf8450000000000000000c130000000000000000000000000000000000000000000000000aa8755544444433333333333333222222222222222222222222222222222222222222221111111111
-- 061:1111111111111111111111111111111111111111111111111111111334444444444445555555566898899ac1d00000000000000000054500000000000000000000000000000000000000000000000007f7655544444433333333333333222222222222222222222222222222222222222222221111111111
-- 062:111111111111111111111111111111111111111111111111111111134444444444445555666667782aa99bcf80000000000000000000880000000000000000000000000000000000000000000000007837655544444433333333333333222222222222222222222222222222222222222222221111111111
-- 063:11111111111111111111111111111111111111111111111111111113444444444445566666667788bfbb6dea000000000000000000008d0000000000000000000000000000000000000000000000006b86655544444433333333333333222222222222222222222222222222222222222222221111111111
-- 064:11111111111111111111111111111111111111111111111111111114444444444456666666777789ad2ec11e00000000000000000000040000000000000000000000000000000000000000000000003976655544444433333333333333222222222222222222222222222222222222222222221111111111
-- 065:11111111111111111111111111111111111111111111111111111114555555556776666667777899bec256810000000000000000000001000000000000000000000000000000000000000000000000a876555544444433333333333333222222222222222222222222222222222222222222221111111111
-- 066:11111111111111111111111111111111111111111111111111111115555666679977777788889aab2180000a000000000000000000000800000000000000000000000000000000000000000000001b8766555544444433333333333333222222222222222222222222222222222222222222221111111111
-- 067:1111111111111111111111111111111111111111111111111111111555666777ae99889a9899b3dd2b20000800000000000000000000060000000000000000000000000000000000000000000005b98766555544444433333333333333222222222222222222222222222222222222222222221111111111
-- 068:11111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000053da98766555544444433333333333333222222222222222222222222222222222222222222221111111111
-- 069:1111111111111111111111111111111111111111111111111111111555666777ae99889a9899b3dd2b20000800000000000000000000060000000000000000000000000000000000000000000005b98766555544444433333333333333222222222222222222222222222222222222222222221111111111
-- 070:11111111111111111111111111111111111111111111111111111115555666679977777788889aab2180000a000000000000000000000800000000000000000000000000000000000000000000001b8766555544444433333333333333222222222222222222222222222222222222222222221111111111
-- 071:11111111111111111111111111111111111111111111111111111114555555556776666667777899bec256810000000000000000000001000000000000000000000000000000000000000000000000a876555544444433333333333333222222222222222222222222222222222222222222221111111111
-- 072:11111111111111111111111111111111111111111111111111111114444444444456666666777789ad2ec11e00000000000000000000040000000000000000000000000000000000000000000000003976655544444433333333333333222222222222222222222222222222222222222222221111111111
-- 073:11111111111111111111111111111111111111111111111111111113444444444445566666667788bfbb6dea000000000000000000008d0000000000000000000000000000000000000000000000006b86655544444433333333333333222222222222222222222222222222222222222222221111111111
-- 074:111111111111111111111111111111111111111111111111111111134444444444445555666667782aa99bcf80000000000000000000880000000000000000000000000000000000000000000000007837655544444433333333333333222222222222222222222222222222222222222222221111111111
-- 075:1111111111111111111111111111111111111111111111111111111334444444444445555555566898899ac1d00000000000000000054500000000000000000000000000000000000000000000000007f7655544444433333333333333222222222222222222222222222222222222222222221111111111
-- 076:1111111111111111111111111111111111111111111111111111111334444444444444555555555677888abf8450000000000000000c130000000000000000000000000000000000000000000000000aa8755544444433333333333333222222222222222222222222222222222222222222221111111111
-- 077:11111111111111111111111111111111111111111111111111111113334444444444444555555555677778abce4e00000000000000eee160000000000000000000000000000000000000000000000000d1765544444433333333333333222222222222222222222222222222222222222222221111111111
-- 078:1111111111111111111111111111111111111111111111111111111233344444444444445555555556777799be4000000000000002edde800000000000000000000000000000000000000000000000005e865544444433333333333332222222222222222222222222222222222222222222221111111111
-- 079:1111111111111111111111111111111111111111111111111111111233334444444444444555555556677789aec00084f8000f04ddbbcd89000000000000000000000000000000000000000000000001bb765544444333333333333332222222222222222222222222222222222222222222211111111111
-- 080:1111111111111111111111111111111111111111111111111111111133333444444444444455555555667789ad1141fb2c09551d5baabc40000000000000000000000000000000000000000000000006a8765544444333333333333332222222222222222222222222222222222222222222211111111111
-- 081:111111111111111111111111111111111111111111111111111111113333334444444444444555555566778abed211ccd2f4d7dba99aab2110000000000000000000000000000000000000000000000fb9765544444333333333333332222222222222222222222222222222222222222222211111111111
-- 082:111111111111111111111111111111111111111111111111111111112333333344444444444455555566688d29fecaabd21cbcc99999aac2d0000000000000000000000000000000000000000000000041865544444333333333333322222222222222222222222222222222222222222222211111111111
-- 083:11111111111111111111111111111111111111111111111111111111233333333344444444444555556668a9ba9aa99a5eb9998888889abd0d00000000000000000000000000000000000000000000000bc75544443333333333333322222222222222222222222222222222222222222222211111111111
-- 084:11111111111111111111111111111111111111111111111111111111233333333333444444444455555667aea8877788b7988777778889df8800000000000000000000000000000000000000000000c012a75544443333333333333322222222222222222222222222222222222222222222211111111111
-- 085:1111111111111111111111111111111111111111111111111111111122333333333333344444444455566793887777778b8777777778889be250000000000000000000000000000000000000000006d8bb675544443333333333333222222222222222222222222222222222222222222222211111111111
-- 086:11111111111111111111111111111111111111111111111111111111123333333333333333444444455567bc87666666666777777777889ac700000000000000000000000000000000000000000002b999965544443333333333333222222222222222222222222222222222222222222222111111111111
-- 087:111111111111111111111111111111111111111111111111111111111233333333333333333334444445588766666666666666666777789ac20000000000000000000000000000000000000000006eb887655544433333333333333222222222222222222222222222222222222222222222111111111111
-- 088:111111111111111111111111111111111111111111111111111111111223333333333333333333334444456666665555555556666667778b96379000000000000000000000000000000000000000cb9876655544433333333333332222222222222222222222222222222222222222222222111111111111
-- 089:111111111111111111111111111111111111111111111111111111111223333333333333333333333344444555555555555555566666677bc21e3000000000000000000000000000000000000036fb9776655444433333333333332222222222222222222222222222222222222222222222111111111111
-- 090:11111111111111111111111111111111111111111111111111111111122333333333333333333333333344444555555555555555666666789ddbd72900000000000000000000000000000000000063a776555444333333333333332222222222222222222222222222222222222222222221111111111111
-- 091:1111111111111111111111111111111111111111111111111111111111223333333333333333333333333344444555555555555555666667889abe5700000000000000000000000000000000e000041876555444333333333333322222222222222222222222222222222222222222222221111111111111
-- 092:11111111111111111111111111111111111111111111111111111111112233333333333333333333333333344444455555555555555666667889cb400000000000000000000000000000000f900004b976555443333333333333322222222222222222222222222222222222222222222221111111111111
-- 093:11111111111111111111111111111111111111111111111111111111112223333333333333333333333333333444444555555555555566667789bcf000a0000000000000000000000000008f100005fa86554443333333333333222222222222222222222222222222222222222222222221111111111111
-- 094:1111111111111111111111111111111111111111111111111111111111122333333333333333333333333333334444444455555555555666678ac1c00094000000000000000000000000e34cc183421d86554443333333333333222222222222222222222222222222222222222222222211111111111111
-- 095:111111111111111111111111111111111111111111111111111111111112223333333333333333333333333333334444444445555555556667868346deed100c000000000000000000d0cebaaf1dbd2be6554433333333333332222222222222222222222222222222222222222222222211111111111111
-- 096:1111111111111111111111111111111111111111111111111111111111122223333333333333333333333333333334444444444555555556678ae56131bbd705505000000000000f0c11ba9988999df875544433333333333322222222222222222222222222222222222222222222222211111111111111
-- 097:1111111111111111111111111111111111111111111111111111111111112223333333333333333333333333333333444444444445555555678b9846ba9abdfee2144750000f642faecf968877778ae765444333333333333322222222222222222222222222222222222222222222222111111111111111
-- 098:111111111111111111111111111111111111111111111111111111111111222233333333333333333333333333333334444444444444555556a8aab7a8889ccbabce28000000b1dcba9a9877777779c755444333333333333222222222222222222222222222222222222222222222222111111111111111
-- 099:111111111111111111111111111111111111111111111111111111111111222223333333333333333333333333333333344444444444445555677789887788999abea000000005db998877666666677554443333333333332222222222222222222222222222222222222222222222222111111111111111
-- 100:111111111111111111111111111111111111111111111111111111111111122223333333333333333333333333333333334444444444444455566666677777889abe300000000dea988776666666655544443333333333332222222222222222222222222222222222222222222222221111111111111111
-- 101:11111111111111111111111111111111111111111111111111111111111112222233333333333333333333333333333333344444444444444455566666667778892600000000047b887766665555555444433333333333322222222222222222222222222222222222222222222222221111111111111111
-- 102:1111111111111111111111111111111111111111111111111111111111111122222333333333333333333333333333333333444444444444444555566666677788b3d000000009ea877666555555544444433333333333222222222222222222222222222222222222222222222222211111111111111111
-- 103:1111111111111111111111111111111111111111111111111111111111111122222233333333333333333333333333333333344444444444444445555666667788aea0000000434b876655555555444444333333333332222222222222222222222222222222222222222222222222211111111111111111
-- 104:1111111111111111111111111111111111111111111111111111111111111122222223333333333333333333333333333333333444444444444444555556666789b11400000c62df876555555554444443333333333322222222222222222222222222222222222222222222222222111111111111111111
-- 105:111111111111111111111111111111111111111111111111111111111111111222222333333333333333333333333333333333334444444444444445555556667e332f49c034fccd865555555444444443333333333322222222222222222222222222222222222222222222222222111111111111111111
-- 106:11111111111111111111111111111111111111111111111111111111111111122222223333333333333333333333333333333333344444444444444445555556689dfcdf00c1ca9d765555554444444433333333333222222222222222222222222222222222222222222222222222111111111111111111
-- 107:11111111111111111111111111111111111111111111111111111111111111112222222333333333333333333333333333333333334444444444444444555555677a9ac3a067a887655555444444444333333333332222222222222222222222222222222222222222222222222221111111111111111111
-- 108:111111111111111111111111111111111111111111111111111111111111111122222222333333333333333333333333333333333334444444444444444555555677889eef1c9877655554444444443333333333322222222222222222222222222222222222222222222222222221111111111111111111
-- 109:111111111111111111111111111111111111111111111111111111111111111112222222223333333333333333333333333333333333344444444444444555555567788ab3fb9876655544444444433333333332222222222222222222222222222222222222222222222222222211111111111111111111
-- 110:1111111111111111111111111111111111111111111111111111111111111111122222222223333333333333333333333333333333333344444444444444555555667889bf3c9876655444444444433333333322222222222222222222222222222222222222222222222222222111111111111111111111
-- 111:1111111111111111111111111111111111111111111111111111111111111111112222222222333333333333333333333333333333333334444444444444455555567789bec14176554444444444333333333222222222222222222222222222222222222222222222222222222111111111111111111111
-- 112:111111111111111111111111111111111111111111111111111111111111111111122222222223333333333333333333333333333333333334444444444444555556679bba9a9ea6544444444433333333332222222222222222222222222222222222222222222222222222221111111111111111111111
-- 113:1111111111111111111111111111111111111111111111111111111111111111111222222222222333333333333333333333333333333333334444444444444555566776c8777975444444444333333333222222222222222222222222222222222222222222222222222222221111111111111111111111
-- 114:11111111111111111111111111111111111111111111111111111111111111111111222222222222333333333333333333333333333333333333444444444445555667bd97666654444444443333333332222222222222222222222222222222222222222222222222222222211111111111111111111111
-- 115:11111111111111111111111111111111111111111111111111111111111111111111222222222222233333333333333333333333333333333333334444444444555668b976665544444444433333333322222222222222222222222222222222222222222222222222222222211111111111111111111111
-- 116:11111111111111111111111111111111111111111111111111111111111111111111122222222222222333333333333333333333333333333333333444444444455579b965555444444443333333332222222222222222222222222222222222222222222222222222222222111111111111111111111111
-- 117:111111111111111111111111111111111111111111111111111111111111111111111122222222222222233333333333333333333333333333333333334444444445b97755554444444333333333222222222222222222222222222222222222222222222222222222222221111111111111111111111111
-- 118:111111111111111111111111111111111111111111111111111111111111111111111122222222222222222333333333333333333333333333333333333344444444455555444444433333333322222222222222222222222222222222222222222222222222222222222221111111111111111111111111
-- 119:111111111111111111111111111111111111111111111111111111111111111111111112222222222222222223333333333333333333333333333333333333334444444444444433333333332222222222222222222222222222222222222222222222222222222222222211111111111111111111111111
-- 120:111111111111111111111111111111111111111111111111111111111111111111111111222222222222222222233333333333333333333333333333333333333333333333333333333333222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111
-- 121:111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222333333333333333333333333333333333333333333333333333333322222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111
-- 122:111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222222333333333333333333333333333333333333333333333333322222222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111
-- 123:111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222333333333333333333333333333333333333333333322222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111
-- 124:111111111111111111111111111111111111111111111111111111111111111111111111111222222222222222222222222222233333333333333333333333333333333333222222222222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111111
-- 125:111111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222222222222222333333333333333333333333322222222222222222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111111
-- 126:111111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222222222222222222233333222222222222222222222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111111
-- 127:111111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111111111
-- 128:111111111111111111111111111111111111111111111111111111111111111111111111111111222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111111111
-- 129:111111111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111111111
-- 130:111111111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111111111
-- 131:111111111111111111111111111111111111111111111111111111111111111111111111111111111222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111111111111
-- 132:111111111111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111111111111
-- 133:111111111111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222111111111111111111111111111111111111111
-- 134:111111111111111111111111111111111111111111111111111111111111111111111111111111111111122222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222221111111111111111111111111111111111111111
-- 135:111111111111111111111111111111111111111111111111111111111111111111111111111111111111112222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111111111111111
-- </SCREEN>

-- <PALETTE>
-- 000:000000ff0000ff5500ffaa00ffff00aaff0000ff0000ffaa00ffff00aaff0055ff0000ff5500ffaa00ffff00ffff00aa
-- </PALETTE>

